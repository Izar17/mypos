import{h as Et}from"./tax-8FHrRWQm.js";import{b as Tt,a as u}from"./bootstrap-B2JubnBk.js";import{c as Ut,e as kt}from"./components-CfbAjZ7-.js";import{_ as c,n as Dt}from"./currency-gBUix5n2.js";import{j as Rt}from"./join-array-DLflg2fd.js";import{b as Nt}from"./ns-prompt-popup-Uu9Ikkt9.js";import{_ as Ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as Pt,o as i,c as d,b as t,e as Vt,n as jt,t as s,f as Lt,F as It,g as Bt}from"./runtime-core.esm-bundler-K4i56aP4.js";import"./chart-D2s_fKm5.js";import"./ns-alert-popup-BZCPp3F-.js";import"./ns-avatar-image-szFVNiiS.js";import"./index.es-CuHZTwqh.js";const zt={name:"ns-zreading-report",data(){return{saleReport:"",startDateField:{name:"start_date",type:"datetime",value:ns.date.moment.startOf("day").format()},result:{},isLoading:!1,users:[],ns:window.ns,selectedUser:"",filterUser:{label:c("Filter User"),name:"filterUser",type:"select",value:"",options:[],description:c("Allow you to choose the report type.")},field:{type:"datetimepicker",value:"2021-02-07",name:"date"}}},components:{nsDatepicker:Ut,nsDateTimePicker:kt},computed:{},methods:{__:c,nsCurrency:Dt,joinArray:Rt,printSaleReport(){this.$htmlToPaper("sale-report")},async openUserFiltering(){try{this.isLoading=!0;const l=await new Promise((o,a)=>{Tt.get("/api/users").subscribe({next:r=>{this.users=r,this.isLoading=!1,this.filterUser.options=[{label:c("All Users"),value:""},...this.users.map(e=>({label:e.username,value:e.id}))],Popup.show(Nt,{...this.filterUser,resolve:o,reject:a})},error:r=>{this.isLoading=!1,u.error(c("No user was found for proceeding the filtering.")),a(r)}})}),_=this.users.filter(o=>o.id===l);if(_.length>0){let o=_[0];this.selectedUser=`${o.username} ${o.first_name||o.last_name?o.first_name+" "+o.last_name:""}`,this.filterUser.value=l,this.result=[],this.loadReport()}}catch(l){console.log({exception:l})}},loadReport(){if(this.startDate===null)return u.error(c("Unable to proceed. Select a correct time range.")).subscribe();Et(this.startDate),this.isLoading=!0,Tt.post("/api/reports/xzreading-report",{startDate:this.startDateField.value,user_id:this.filterUser.value}).subscribe({next:l=>{this.isLoading=!1,this.result=l.result,console.log(this.result)},error:l=>{this.isLoading=!1,u.error(l.message).subscribe()}})}},props:["storeLogo","storeName"],mounted(){}},Mt={id:"report-section",class:"px-4"},Gt={class:"flex -mx-2"},Ht={class:"px-2"},Zt={class:"px-2"},Wt={class:"pl-2"},qt={class:"px-2"},Jt=t("i",{class:"las la-print text-xl"},null,-1),Kt={class:"pl-2"},Qt={key:0,class:"w-full h-full pt-5"},Xt={class:"w-full md:w-1/2 lg:w-1/3 shadow-lg bg-white p-2 mx-auto"},Yt={class:"flex items-center justify-center"},$t={class:"text-sm font-bold"},ts={class:"flex items-center justify-center"},ss={class:"text-sm font-bold"},es={class:"flex items-center justify-center"},rs={class:"text-sm font-bold"},ls=t("div",{class:"p-2"},[t("div",{class:"flex flex-wrap -mx-2 text-xs"})],-1),os=["set"],_s={class:"w-full"},cs={key:0},is={class:"text-xs"},ds={colspan:"2",class:"text-left"},as=t("tr",{class:"border-b"},null,-1),us={class:"text-xs"},hs={class:""},ps={class:"text-right"},ms={class:"text-right"},xs={class:""},gs={class:"text-right"},fs={class:"text-right"},bs={class:""},ys={class:"text-right"},vs={class:"text-right"},Cs=t("tr",{class:"border-b"},null,-1),Ss={class:""},ws={class:"text-right"},Fs={class:"text-right"},Ts={class:""},Ls=t("td",null,null,-1),As={class:"text-right"},Es={class:""},Us=t("td",null,null,-1),ks={class:"text-right"},Ds={class:""},Rs=t("td",null,null,-1),Ns={class:"text-right"},Os={class:""},Ps=t("td",null,null,-1),Vs={class:"text-right"},js={class:""},Is=t("td",null,null,-1),Bs={class:"text-right"},zs={class:""},Ms=t("td",null,null,-1),Gs=t("td",{class:"text-right"},"0",-1),Hs=t("tr",{class:"border-b"},null,-1),Zs={class:""},Ws=t("td",null,null,-1),qs={class:"text-right"},Js={class:""},Ks={class:"pl-3"},Qs={class:"text-right"},Xs={class:"text-right"},Ys={class:"pl-3"},$s={class:"text-right"},te={class:"text-right"},se={class:""},ee=t("td",{class:"text-right"},null,-1),re={class:"pl-3"},le={class:"text-right"},oe={class:"text-right"},_e={class:""},ce=t("td",{class:"text-right"},null,-1),ne={class:"pl-3"},ie={class:"text-right"},de={class:"text-right"},ae={class:"pl-3"},ue={class:"text-right"},he={class:"text-right"},pe={class:"pl-3"},me={class:"text-right"},xe={class:"text-right"},ge={class:"pl-3"},fe={class:"text-right"},be={class:"text-right"},ye={class:"pl-3"},ve={class:"text-right"},Ce={class:"text-right"},Se=t("tr",{class:"border-b"},null,-1),we={colspan:"3",class:"text-center"};function Fe(l,_,o,a,r,e){var h,p,m,x,g,f,b,y,v,C,S,w,F,T,L,A,E,U,k,D,R,N,O,P,V,j,I,B,z,M,G,H,Z,W,q,J,K,Q,X,Y,$,tt,st,et,rt,lt,ot,_t,ct,nt,it,dt,at,ut,ht,pt,mt,xt,gt,ft,bt,yt,vt,Ct,St,wt,Ft;const At=Pt("ns-date-time-picker");return i(),d("div",Mt,[t("div",Gt,[t("div",Ht,[Vt(At,{field:r.startDateField},null,8,["field"])]),t("div",Zt,[t("button",{onClick:_[0]||(_[0]=n=>e.loadReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[t("i",{class:jt([r.isLoading?"animate-spin":"","las la-sync-alt text-xl"])},null,2),t("span",Wt,s(e.__("Load")),1)])]),t("div",qt,[t("button",{onClick:_[1]||(_[1]=n=>e.printSaleReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[Jt,t("span",Kt,s(e.__("Print")),1)])])]),t("div",null,[r.result.store_name?(i(),d("div",Qt,[t("div",Xt,[t("div",Yt,[t("p",$t,s(r.result.store_name),1)]),t("div",ts,[t("p",ss,s(r.result.title),1)]),t("div",es,[t("p",rs,s(r.result.date),1)]),ls,t("div",{class:"table w-full text-xs",set:l.vat_12=parseFloat((p=(h=r.result)==null?void 0:h.orders)==null?void 0:p.vatable)+parseFloat((x=(m=r.result)==null?void 0:m.orders)==null?void 0:x.sc_vatable)-(parseFloat((f=(g=r.result)==null?void 0:g.orders)==null?void 0:f.vatable)+parseFloat((y=(b=r.result)==null?void 0:b.orders)==null?void 0:y.sc_vatable))/1.12},[t("table",_s,[r.result.cashier?(i(),d("tr",cs,[t("td",is,s(e.__("Cashier Name:")),1),t("td",ds,s((v=r.result)==null?void 0:v.cashier),1)])):Lt("",!0),as,t("tbody",us,[t("tr",null,[t("td",hs,s(e.__("TOTAL SALES")),1),t("td",ps,s((S=(C=r.result)==null?void 0:C.orders)==null?void 0:S.total_sales_count),1),t("td",ms,s(e.nsCurrency((F=(w=r.result)==null?void 0:w.orders)==null?void 0:F.total_sales)),1)]),t("tr",null,[t("td",xs,s(e.__("LESS TOTAL REFUND")),1),t("td",gs,s((L=(T=r.result)==null?void 0:T.orders)==null?void 0:L.total_refunds_count),1),t("td",fs,s(e.nsCurrency((E=(A=r.result)==null?void 0:A.orders)==null?void 0:E.total_refunds)),1)]),t("tr",null,[t("td",bs,s(e.__("LESS TOTAL DISCOUNT")),1),t("td",ys,s((k=(U=r.result)==null?void 0:U.orders)==null?void 0:k.total_disc_count),1),t("td",vs,s(e.nsCurrency((R=(D=r.result)==null?void 0:D.orders)==null?void 0:R.total_disc)),1)]),Cs,t("tr",null,[t("td",Ss,s(e.__("SUBTOTAL")),1),t("td",ws,s((O=(N=r.result)==null?void 0:N.orders)==null?void 0:O.total_sales_count),1),t("td",Fs,s(e.nsCurrency((V=(P=r.result)==null?void 0:P.orders)==null?void 0:V.subtotal)),1)]),t("tr",null,[t("td",Ts,s(e.__("SERVICE CHARGE")),1),Ls,t("td",As,s(e.nsCurrency((I=(j=r.result)==null?void 0:j.orders)==null?void 0:I.service_charge)),1)]),t("tr",null,[t("td",Es,s(e.__("LESS 12% VAT")),1),Us,t("td",ks,s(e.nsCurrency(l.vat_12||0)),1)]),t("tr",null,[t("td",Ds,s(e.__("NET SALES")),1),Rs,t("td",Ns,s(e.nsCurrency(parseFloat(((z=(B=r.result)==null?void 0:B.orders)==null?void 0:z.total)-l.vat_12)||0)),1)]),t("tr",null,[t("td",Os,s(e.__("VATable Sales")),1),Ps,t("td",Vs,s(e.nsCurrency(parseFloat((G=(M=r.result)==null?void 0:M.orders)==null?void 0:G.vatable)+parseFloat((Z=(H=r.result)==null?void 0:H.orders)==null?void 0:Z.sc_vatable)||0)),1)]),t("tr",null,[t("td",js,s(e.__("VAT-Exempt Sales")),1),Is,t("td",Bs,s(e.nsCurrency(parseFloat((q=(W=r.result)==null?void 0:W.orders)==null?void 0:q.vat_exempt)||0)),1)]),t("tr",null,[t("td",zs,s(e.__("VAT Zero-Rated Sales")),1),Ms,Gs]),Hs,t("tr",null,[t("td",Zs,s(e.__("TERMINAL TOTAL")),1),Ws,t("td",qs,s(e.nsCurrency(parseFloat((K=(J=r.result)==null?void 0:J.orders)==null?void 0:K.total)||0)),1)]),t("tr",null,[t("td",Js,s(e.__("TRANSACTIONS")),1)]),t("tr",null,[t("td",Ks,s(e.__("Dine In")),1),t("td",Qs,s((X=(Q=r.result)==null?void 0:Q.orders)==null?void 0:X.dinein_count),1),t("td",Xs,s(e.nsCurrency(parseFloat(($=(Y=r.result)==null?void 0:Y.orders)==null?void 0:$.dinein_total)||0)),1)]),t("tr",null,[t("td",Ys,s(e.__("Take Away")),1),t("td",$s,s((st=(tt=r.result)==null?void 0:tt.orders)==null?void 0:st.takeaway_count),1),t("td",te,s(e.nsCurrency(parseFloat((rt=(et=r.result)==null?void 0:et.orders)==null?void 0:rt.takeaway_total)||0)),1)]),t("tr",null,[t("td",se,s(e.__("TENDERS")),1),ee]),(i(!0),d(It,null,Bt((lt=r.result)==null?void 0:lt.payments,n=>(i(),d("tr",null,[t("td",re,s(n.label),1),t("td",le,s(n.count),1),t("td",oe,s(e.nsCurrency(parseFloat(n.total))),1)]))),256)),t("tr",null,[t("td",_e,s(e.__("DISCOUNTS")),1),ce]),t("tr",null,[t("td",ne,s(e.__("SC")),1),t("td",ie,s((_t=(ot=r.result)==null?void 0:ot.orders)==null?void 0:_t.sc_count_disc),1),t("td",de,s(e.nsCurrency(parseFloat((nt=(ct=r.result)==null?void 0:ct.orders)==null?void 0:nt.sc_total_disc)||0)),1)]),t("tr",null,[t("td",ae,s(e.__("PWD")),1),t("td",ue,s((dt=(it=r.result)==null?void 0:it.orders)==null?void 0:dt.pwd_count_disc),1),t("td",he,s(e.nsCurrency(parseFloat((ut=(at=r.result)==null?void 0:at.orders)==null?void 0:ut.pwd_total_disc)||0)),1)]),t("tr",null,[t("td",pe,s(e.__("EMP10")),1),t("td",me,s((pt=(ht=r.result)==null?void 0:ht.orders)==null?void 0:pt.emp10_count_disc),1),t("td",xe,s(e.nsCurrency(parseFloat((xt=(mt=r.result)==null?void 0:mt.orders)==null?void 0:xt.emp10_total_disc)||0)),1)]),t("tr",null,[t("td",ge,s(e.__("EMP15")),1),t("td",fe,s((ft=(gt=r.result)==null?void 0:gt.orders)==null?void 0:ft.emp15_count_disc),1),t("td",be,s(e.nsCurrency(parseFloat((yt=(bt=r.result)==null?void 0:bt.orders)==null?void 0:yt.emp15_total_disc)||0)),1)]),t("tr",null,[t("td",ye,s(e.__("REG")),1),t("td",ve,s((Ct=(vt=r.result)==null?void 0:vt.orders)==null?void 0:Ct.reg_count_disc),1),t("td",Ce,s(e.nsCurrency(parseFloat((wt=(St=r.result)==null?void 0:St.orders)==null?void 0:wt.reg_total_disc)||0)),1)]),Se,t("tr",null,[t("td",we,s((Ft=r.result)==null?void 0:Ft.generated_date),1)])])])],8,os)])])):Lt("",!0)])])}const je=Ot(zt,[["render",Fe]]);export{je as default};

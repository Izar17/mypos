import{h as At}from"./tax-Ce1VQMwg.js";import{b as Tt,a as u}from"./bootstrap-B9n0c8ym.js";import{c as Et,e as kt}from"./components-DZKu-DBO.js";import{_ as c,n as Rt}from"./currency-gBUix5n2.js";import{j as Dt}from"./join-array-DLflg2fd.js";import{b as Nt}from"./ns-prompt-popup-BUjip02s.js";import{_ as Ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as Vt,o as i,c as d,b as t,e as Pt,t as s,n as jt,f as Lt,F as Bt,g as It}from"./runtime-core.esm-bundler-DHuczvMQ.js";import"./chart-CwFtjAqO.js";import"./ns-alert-popup-C7_0jNgS.js";import"./ns-avatar-image-38FliACJ.js";import"./index.es-BamOKBrQ.js";const zt={name:"ns-xreading-report",data(){return{saleReport:"",startDateField:{name:"start_date",type:"datetime",value:ns.date.moment.startOf("day").format()},result:{},isLoading:!1,users:[],ns:window.ns,selectedUser:"",filterUser:{label:c("Filter User"),name:"filterUser",type:"select",value:"",options:[],description:c("Allow you to choose the report type.")},field:{type:"datetimepicker",value:"2021-02-07",name:"date"}}},components:{nsDatepicker:Et,nsDateTimePicker:kt},computed:{},methods:{__:c,nsCurrency:Rt,joinArray:Dt,printSaleReport(){this.$htmlToPaper("sale-report")},async openUserFiltering(){try{this.isLoading=!0;const l=await new Promise((o,a)=>{Tt.get("/api/users").subscribe({next:r=>{this.users=r,this.isLoading=!1,this.filterUser.options=[{label:c("All Users"),value:""},...this.users.map(e=>({label:e.username,value:e.id}))],Popup.show(Nt,{...this.filterUser,resolve:o,reject:a})},error:r=>{this.isLoading=!1,u.error(c("No user was found for proceeding the filtering.")),a(r)}})}),_=this.users.filter(o=>o.id===l);if(_.length>0){let o=_[0];this.selectedUser=`${o.username} ${o.first_name||o.last_name?o.first_name+" "+o.last_name:""}`,this.filterUser.value=l,this.result=[],this.loadReport()}}catch(l){console.log({exception:l})}},loadReport(){if(this.startDate===null)return u.error(c("Unable to proceed. Select a correct time range.")).subscribe();At(this.startDate),this.isLoading=!0,Tt.post("/api/reports/xzreading-report",{startDate:this.startDateField.value,user_id:this.filterUser.value}).subscribe({next:l=>{this.isLoading=!1,this.result=l.result,console.log(this.result)},error:l=>{this.isLoading=!1,u.error(l.message).subscribe()}})}},props:["storeLogo","storeName"],mounted(){}},Gt={id:"report-section",class:"px-4"},Ht={class:"flex -mx-2"},Mt={class:"px-2"},Wt={class:"px-2"},Xt=t("i",{class:"las la-filter text-xl"},null,-1),Zt={class:"pl-2"},qt={class:"px-2"},Jt={class:"pl-2"},Kt={class:"px-2"},Qt=t("i",{class:"las la-print text-xl"},null,-1),Yt={class:"pl-2"},$t={id:"sale-report",class:"anim-duration-500 fade-in-entrance"},ts={key:0,class:"w-full h-full pt-5"},ss={class:"w-full md:w-1/2 lg:w-1/3 shadow-lg bg-white p-2 mx-auto"},es={class:"flex items-center justify-center"},rs={class:"text-sm font-bold"},ls={class:"flex items-center justify-center"},os={class:"text-sm font-bold"},_s={class:"flex items-center justify-center"},cs={class:"text-sm font-bold"},is=t("div",{class:"p-2"},[t("div",{class:"flex flex-wrap -mx-2 text-xs"})],-1),ds=["set"],as={class:"w-full"},us={key:0},hs={class:"text-xs"},ps=t("tr",{class:"border-b"},null,-1),xs={class:"text-xs"},ms={class:""},gs={class:"text-right"},fs={class:"text-right"},bs={class:""},ys={class:"text-right"},vs={class:"text-right"},Cs={class:""},Ss={class:"text-right"},ws={class:"text-right"},Fs=t("tr",{class:"border-b"},null,-1),Ts={class:""},Ls={class:"text-right"},Us={class:"text-right"},As={class:""},Es=t("td",null,null,-1),ks={class:"text-right"},Rs={class:""},Ds=t("td",null,null,-1),Ns={class:"text-right"},Os={class:""},Vs=t("td",null,null,-1),Ps={class:"text-right"},js={class:""},Bs=t("td",null,null,-1),Is={class:"text-right"},zs={class:""},Gs=t("td",null,null,-1),Hs={class:"text-right"},Ms={class:""},Ws=t("td",null,null,-1),Xs=t("td",{class:"text-right"},"0",-1),Zs=t("tr",{class:"border-b"},null,-1),qs={class:""},Js=t("td",null,null,-1),Ks={class:"text-right"},Qs={class:""},Ys={class:"pl-3"},$s={class:"text-right"},te={class:"text-right"},se={class:"pl-3"},ee={class:"text-right"},re={class:"text-right"},le={class:""},oe=t("td",{class:"text-right"},null,-1),_e={class:"pl-3"},ne={class:"text-right"},ce={class:"text-right"},ie={class:""},de=t("td",{class:"text-right"},null,-1),ae={class:"pl-3"},ue={class:"text-right"},he={class:"text-right"},pe={class:"pl-3"},xe={class:"text-right"},me={class:"text-right"},ge={class:"pl-3"},fe={class:"text-right"},be={class:"text-right"},ye={class:"pl-3"},ve={class:"text-right"},Ce={class:"text-right"},Se={class:"pl-3"},we={class:"text-right"},Fe={class:"text-right"},Te=t("tr",{class:"border-b"},null,-1),Le={colspan:"3",class:"text-center"};function Ue(l,_,o,a,r,e){var h,p,x,m,g,f,b,y,v,C,S,w,F,T,L,U,A,E,k,R,D,N,O,V,P,j,B,I,z,G,H,M,W,X,Z,q,J,K,Q,Y,$,tt,st,et,rt,lt,ot,_t,nt,ct,it,dt,at,ut,ht,pt,xt,mt,gt,ft,bt,yt,vt,Ct,St,wt,Ft;const Ut=Vt("ns-date-time-picker");return i(),d("div",Gt,[t("div",Ht,[t("div",Mt,[Pt(Ut,{field:r.startDateField},null,8,["field"])]),t("div",Wt,[t("button",{onClick:_[0]||(_[0]=n=>e.openUserFiltering()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[Xt,t("span",Zt,s(e.__("By User"))+" : "+s(r.selectedUser||e.__("All Users")),1)])]),t("div",qt,[t("button",{onClick:_[1]||(_[1]=n=>e.loadReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[t("i",{class:jt([r.isLoading?"animate-spin":"","las la-sync-alt text-xl"])},null,2),t("span",Jt,s(e.__("Load")),1)])]),t("div",Kt,[t("button",{onClick:_[2]||(_[2]=n=>e.printSaleReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[Qt,t("span",Yt,s(e.__("Print")),1)])])]),t("div",null,[t("div",$t,[r.result.store_name?(i(),d("div",ts,[t("div",ss,[t("div",es,[t("p",rs,s(r.result.store_name),1)]),t("div",ls,[t("p",os,s(r.result.title),1)]),t("div",_s,[t("p",cs,s(r.result.date),1)]),is,t("div",{class:"table w-full text-xs",set:l.vat_12=parseFloat((p=(h=r.result)==null?void 0:h.orders)==null?void 0:p.vatable)+parseFloat((m=(x=r.result)==null?void 0:x.orders)==null?void 0:m.sc_vatable)-(parseFloat((f=(g=r.result)==null?void 0:g.orders)==null?void 0:f.vatable)+parseFloat((y=(b=r.result)==null?void 0:b.orders)==null?void 0:y.sc_vatable))/1.12},[t("table",as,[r.result.cashier?(i(),d("tr",us,[t("td",hs,s(e.__("Cashier Name:"))+" "+s((v=r.result)==null?void 0:v.cashier),1)])):Lt("",!0),ps,t("tbody",xs,[t("tr",null,[t("td",ms,s(e.__("TOTAL SALES")),1),t("td",gs,s((S=(C=r.result)==null?void 0:C.orders)==null?void 0:S.total_sales_count),1),t("td",fs,s(e.nsCurrency((F=(w=r.result)==null?void 0:w.orders)==null?void 0:F.total_sales)),1)]),t("tr",null,[t("td",bs,s(e.__("LESS TOTAL REFUND")),1),t("td",ys,s((L=(T=r.result)==null?void 0:T.orders)==null?void 0:L.total_refunds_count),1),t("td",vs,s(e.nsCurrency((A=(U=r.result)==null?void 0:U.orders)==null?void 0:A.total_refunds)),1)]),t("tr",null,[t("td",Cs,s(e.__("LESS TOTAL DISCOUNT")),1),t("td",Ss,s((k=(E=r.result)==null?void 0:E.orders)==null?void 0:k.total_disc_count),1),t("td",ws,s(e.nsCurrency((D=(R=r.result)==null?void 0:R.orders)==null?void 0:D.total_disc)),1)]),Fs,t("tr",null,[t("td",Ts,s(e.__("SUBTOTAL")),1),t("td",Ls,s((O=(N=r.result)==null?void 0:N.orders)==null?void 0:O.total_sales_count),1),t("td",Us,s(e.nsCurrency((P=(V=r.result)==null?void 0:V.orders)==null?void 0:P.subtotal)),1)]),t("tr",null,[t("td",As,s(e.__("SERVICE CHARGE")),1),Es,t("td",ks,s(e.nsCurrency((B=(j=r.result)==null?void 0:j.orders)==null?void 0:B.service_charge)),1)]),t("tr",null,[t("td",Rs,s(e.__("LESS 12% VAT")),1),Ds,t("td",Ns,s(e.nsCurrency(l.vat_12||0)),1)]),t("tr",null,[t("td",Os,s(e.__("NET SALES")),1),Vs,t("td",Ps,s(e.nsCurrency(parseFloat(((z=(I=r.result)==null?void 0:I.orders)==null?void 0:z.total)-l.vat_12)||0)),1)]),t("tr",null,[t("td",js,s(e.__("VATable Sales")),1),Bs,t("td",Is,s(e.nsCurrency(parseFloat((H=(G=r.result)==null?void 0:G.orders)==null?void 0:H.vatable)+parseFloat((W=(M=r.result)==null?void 0:M.orders)==null?void 0:W.sc_vatable)||0)),1)]),t("tr",null,[t("td",zs,s(e.__("VAT-Exempt Sales")),1),Gs,t("td",Hs,s(e.nsCurrency(parseFloat((Z=(X=r.result)==null?void 0:X.orders)==null?void 0:Z.vat_exempt)||0)),1)]),t("tr",null,[t("td",Ms,s(e.__("VAT Zero-Rated Sales")),1),Ws,Xs]),Zs,t("tr",null,[t("td",qs,s(e.__("TERMINAL TOTAL")),1),Js,t("td",Ks,s(e.nsCurrency(parseFloat((J=(q=r.result)==null?void 0:q.orders)==null?void 0:J.total)||0)),1)]),t("tr",null,[t("td",Qs,s(e.__("TRANSACTIONS")),1)]),t("tr",null,[t("td",Ys,s(e.__("Dine In")),1),t("td",$s,s((Q=(K=r.result)==null?void 0:K.orders)==null?void 0:Q.dinein_count),1),t("td",te,s(e.nsCurrency(parseFloat(($=(Y=r.result)==null?void 0:Y.orders)==null?void 0:$.dinein_total)||0)),1)]),t("tr",null,[t("td",se,s(e.__("Take Away")),1),t("td",ee,s((st=(tt=r.result)==null?void 0:tt.orders)==null?void 0:st.takeaway_count),1),t("td",re,s(e.nsCurrency(parseFloat((rt=(et=r.result)==null?void 0:et.orders)==null?void 0:rt.takeaway_total)||0)),1)]),t("tr",null,[t("td",le,s(e.__("TENDERS")),1),oe]),(i(!0),d(Bt,null,It((lt=r.result)==null?void 0:lt.payments,n=>(i(),d("tr",null,[t("td",_e,s(n.label),1),t("td",ne,s(n.count),1),t("td",ce,s(e.nsCurrency(parseFloat(n.total))),1)]))),256)),t("tr",null,[t("td",ie,s(e.__("DISCOUNTS")),1),de]),t("tr",null,[t("td",ae,s(e.__("SC")),1),t("td",ue,s((_t=(ot=r.result)==null?void 0:ot.orders)==null?void 0:_t.sc_count_disc),1),t("td",he,s(e.nsCurrency(parseFloat((ct=(nt=r.result)==null?void 0:nt.orders)==null?void 0:ct.sc_total_disc)||0)),1)]),t("tr",null,[t("td",pe,s(e.__("PWD")),1),t("td",xe,s((dt=(it=r.result)==null?void 0:it.orders)==null?void 0:dt.pwd_count_disc),1),t("td",me,s(e.nsCurrency(parseFloat((ut=(at=r.result)==null?void 0:at.orders)==null?void 0:ut.pwd_total_disc)||0)),1)]),t("tr",null,[t("td",ge,s(e.__("EMP")),1),t("td",fe,s((pt=(ht=r.result)==null?void 0:ht.orders)==null?void 0:pt.emp_count_disc),1),t("td",be,s(e.nsCurrency(parseFloat((mt=(xt=r.result)==null?void 0:xt.orders)==null?void 0:mt.emp_total_disc)||0)),1)]),t("tr",null,[t("td",ye,s(e.__("FREE")),1),t("td",ve,s((ft=(gt=r.result)==null?void 0:gt.orders)==null?void 0:ft.free_count_disc),1),t("td",Ce,s(e.nsCurrency(parseFloat((yt=(bt=r.result)==null?void 0:bt.orders)==null?void 0:yt.free_total_disc)||0)),1)]),t("tr",null,[t("td",Se,s(e.__("REG")),1),t("td",we,s((Ct=(vt=r.result)==null?void 0:vt.orders)==null?void 0:Ct.reg_count_disc),1),t("td",Fe,s(e.nsCurrency(parseFloat((wt=(St=r.result)==null?void 0:St.orders)==null?void 0:wt.reg_total_disc)||0)),1)]),Te,t("tr",null,[t("td",Le,s((Ft=r.result)==null?void 0:Ft.generated_date),1)])])])],8,ds)])])):Lt("",!0)])])])}const ze=Ot(zt,[["render",Ue]]);export{ze as default};

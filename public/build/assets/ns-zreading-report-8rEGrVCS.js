import{d as Tt,a as u,h as Et}from"./bootstrap-Cq4cdc46.js";import{c as Ut,e as kt}from"./components-D4bDCSZv.js";import{_ as n,n as Rt}from"./currency-Dtag6qPd.js";import{j as Dt}from"./join-array-NDqpMoMN.js";import{b as Nt}from"./ns-prompt-popup-ncfXAYOx.js";import{_ as Vt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as Ot,o as i,c as d,a as t,b as Pt,n as jt,t as s,j as It,e as Lt,F as Bt,f as zt}from"./runtime-core.esm-bundler-fVX7Ok1h.js";import"./chart-CwFtjAqO.js";import"./ns-alert-popup-BwNvX-JB.js";import"./ns-avatar-image-COxrQ3b-.js";import"./index.es-CL3uzDSn.js";const Gt={name:"ns-zreading-report",data(){return{saleReport:"",startDateField:{name:"start_date",type:"datetime",value:ns.date.moment.startOf("day").format()},result:{},isLoading:!1,users:[],ns:window.ns,selectedUser:"",filterUser:{label:n("Filter User"),name:"filterUser",type:"select",value:"",options:[],description:n("Allow you to choose the report type.")},field:{type:"datetimepicker",value:"2021-02-07",name:"date"}}},components:{nsDatepicker:Ut,nsDateTimePicker:kt},computed:{},methods:{__:n,nsCurrency:Rt,joinArray:Dt,printSaleReport(){this.$htmlToPaper("sale-report")},async openUserFiltering(){try{this.isLoading=!0;const l=await new Promise((o,a)=>{Tt.get("/api/users").subscribe({next:r=>{this.users=r,this.isLoading=!1,this.filterUser.options=[{label:n("All Users"),value:""},...this.users.map(e=>({label:e.username,value:e.id}))],Popup.show(Nt,{...this.filterUser,resolve:o,reject:a})},error:r=>{this.isLoading=!1,u.error(n("No user was found for proceeding the filtering.")),a(r)}})}),_=this.users.filter(o=>o.id===l);if(_.length>0){let o=_[0];this.selectedUser=`${o.username} ${o.first_name||o.last_name?o.first_name+" "+o.last_name:""}`,this.filterUser.value=l,this.result=[],this.loadReport()}}catch(l){console.log({exception:l})}},loadReport(){if(this.startDate===null)return u.error(n("Unable to proceed. Select a correct time range.")).subscribe();Et(this.startDate),this.isLoading=!0,Tt.post("/api/reports/xzreading-report",{startDate:this.startDateField.value,user_id:this.filterUser.value}).subscribe({next:l=>{this.isLoading=!1,this.result=l.result,console.log(this.result)},error:l=>{this.isLoading=!1,u.error(l.message).subscribe()}})}},props:["storeLogo","storeName"],mounted(){}},Ht={id:"report-section",class:"px-4"},Mt={class:"flex -mx-2"},Zt={class:"px-2"},Wt={class:"px-2"},qt={class:"pl-2"},Jt={class:"px-2"},Kt=t("i",{class:"las la-print text-xl"},null,-1),Qt={class:"pl-2"},Xt={id:"sale-report",class:"anim-duration-500 fade-in-entrance"},Yt={key:0,class:"w-full h-full pt-5"},$t={class:"w-full md:w-1/2 lg:w-1/3 shadow-lg bg-white p-2 mx-auto"},ts={class:"flex items-center justify-center"},ss={class:"text-sm font-bold"},es={class:"flex items-center justify-center"},rs={class:"text-sm font-bold"},ls={class:"flex items-center justify-center"},os={class:"text-sm font-bold"},_s=t("div",{class:"p-2"},[t("div",{class:"flex flex-wrap -mx-2 text-xs"})],-1),cs=["set"],is={class:"w-full"},ds={key:0},as={class:"text-xs"},us={colspan:"2",class:"text-left"},hs=t("tr",{class:"border-b"},null,-1),ps={class:"text-xs"},ms={class:""},xs={class:"text-right"},gs={class:"text-right"},fs={class:""},bs={class:"text-right"},ys={class:"text-right"},vs={class:""},Cs={class:"text-right"},Ss={class:"text-right"},Fs=t("tr",{class:"border-b"},null,-1),ws={class:""},Ts={class:"text-right"},Ls={class:"text-right"},As={class:""},Es=t("td",null,null,-1),Us={class:"text-right"},ks={class:""},Rs=t("td",null,null,-1),Ds={class:"text-right"},Ns={class:""},Vs=t("td",null,null,-1),Os={class:"text-right"},Ps={class:""},js=t("td",null,null,-1),Is={class:"text-right"},Bs={class:""},zs=t("td",null,null,-1),Gs={class:"text-right"},Hs={class:""},Ms=t("td",null,null,-1),Zs=t("td",{class:"text-right"},"0",-1),Ws=t("tr",{class:"border-b"},null,-1),qs={class:""},Js=t("td",null,null,-1),Ks={class:"text-right"},Qs={class:""},Xs={class:"pl-3"},Ys={class:"text-right"},$s={class:"text-right"},te={class:"pl-3"},se={class:"text-right"},ee={class:"text-right"},re={class:""},le=t("td",{class:"text-right"},null,-1),oe={class:"pl-3"},_e={class:"text-right"},ne={class:"text-right"},ce={class:""},ie=t("td",{class:"text-right"},null,-1),de={class:"pl-3"},ae={class:"text-right"},ue={class:"text-right"},he={class:"pl-3"},pe={class:"text-right"},me={class:"text-right"},xe={class:"pl-3"},ge={class:"text-right"},fe={class:"text-right"},be={class:"pl-3"},ye={class:"text-right"},ve={class:"text-right"},Ce={class:"pl-3"},Se={class:"text-right"},Fe={class:"text-right"},we=t("tr",{class:"border-b"},null,-1),Te={colspan:"3",class:"text-center"};function Le(l,_,o,a,r,e){var h,p,m,x,g,f,b,y,v,C,S,F,w,T,L,A,E,U,k,R,D,N,V,O,P,j,I,B,z,G,H,M,Z,W,q,J,K,Q,X,Y,$,tt,st,et,rt,lt,ot,_t,nt,ct,it,dt,at,ut,ht,pt,mt,xt,gt,ft,bt,yt,vt,Ct,St,Ft,wt;const At=Ot("ns-date-time-picker");return i(),d("div",Ht,[t("div",Mt,[t("div",Zt,[Pt(At,{field:r.startDateField},null,8,["field"])]),t("div",Wt,[t("button",{onClick:_[0]||(_[0]=c=>e.loadReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[t("i",{class:jt([r.isLoading?"animate-spin":"","las la-sync-alt text-xl"])},null,2),t("span",qt,s(e.__("Load")),1)])]),t("div",Jt,[t("button",{onClick:_[1]||(_[1]=c=>e.printSaleReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[Kt,t("span",Qt,s(e.__("Print")),1)]),It("test ")])]),t("div",null,[t("div",Xt,[r.result.store_name?(i(),d("div",Yt,[t("div",$t,[t("div",ts,[t("p",ss,s(r.result.store_name),1)]),t("div",es,[t("p",rs,s(r.result.title),1)]),t("div",ls,[t("p",os,s(r.result.date),1)]),_s,t("div",{class:"table w-full text-xs",set:l.vat_12=parseFloat((p=(h=r.result)==null?void 0:h.orders)==null?void 0:p.vatable)+parseFloat((x=(m=r.result)==null?void 0:m.orders)==null?void 0:x.sc_vatable)-(parseFloat((f=(g=r.result)==null?void 0:g.orders)==null?void 0:f.vatable)+parseFloat((y=(b=r.result)==null?void 0:b.orders)==null?void 0:y.sc_vatable))/1.12},[t("table",is,[r.result.cashier?(i(),d("tr",ds,[t("td",as,s(e.__("Cashier Name:")),1),t("td",us,s((v=r.result)==null?void 0:v.cashier),1)])):Lt("",!0),hs,t("tbody",ps,[t("tr",null,[t("td",ms,s(e.__("TOTAL SALES")),1),t("td",xs,s((S=(C=r.result)==null?void 0:C.orders)==null?void 0:S.total_sales_count),1),t("td",gs,s(e.nsCurrency((w=(F=r.result)==null?void 0:F.orders)==null?void 0:w.total_sales)),1)]),t("tr",null,[t("td",fs,s(e.__("LESS TOTAL REFUND")),1),t("td",bs,s((L=(T=r.result)==null?void 0:T.orders)==null?void 0:L.total_refunds_count),1),t("td",ys,s(e.nsCurrency((E=(A=r.result)==null?void 0:A.orders)==null?void 0:E.total_refunds)),1)]),t("tr",null,[t("td",vs,s(e.__("LESS TOTAL DISCOUNT")),1),t("td",Cs,s((k=(U=r.result)==null?void 0:U.orders)==null?void 0:k.total_disc_count),1),t("td",Ss,s(e.nsCurrency((D=(R=r.result)==null?void 0:R.orders)==null?void 0:D.total_disc)),1)]),Fs,t("tr",null,[t("td",ws,s(e.__("SUBTOTAL")),1),t("td",Ts,s((V=(N=r.result)==null?void 0:N.orders)==null?void 0:V.total_sales_count),1),t("td",Ls,s(e.nsCurrency((P=(O=r.result)==null?void 0:O.orders)==null?void 0:P.subtotal)),1)]),t("tr",null,[t("td",As,s(e.__("SERVICE CHARGE")),1),Es,t("td",Us,s(e.nsCurrency((I=(j=r.result)==null?void 0:j.orders)==null?void 0:I.service_charge)),1)]),t("tr",null,[t("td",ks,s(e.__("LESS 12% VAT")),1),Rs,t("td",Ds,s(e.nsCurrency(l.vat_12||0)),1)]),t("tr",null,[t("td",Ns,s(e.__("NET SALES")),1),Vs,t("td",Os,s(e.nsCurrency(parseFloat(((z=(B=r.result)==null?void 0:B.orders)==null?void 0:z.total)-l.vat_12)||0)),1)]),t("tr",null,[t("td",Ps,s(e.__("VATable Sales")),1),js,t("td",Is,s(e.nsCurrency(parseFloat((H=(G=r.result)==null?void 0:G.orders)==null?void 0:H.vatable)+parseFloat((Z=(M=r.result)==null?void 0:M.orders)==null?void 0:Z.sc_vatable)||0)),1)]),t("tr",null,[t("td",Bs,s(e.__("VAT-Exempt Sales")),1),zs,t("td",Gs,s(e.nsCurrency(parseFloat((q=(W=r.result)==null?void 0:W.orders)==null?void 0:q.vat_exempt)||0)),1)]),t("tr",null,[t("td",Hs,s(e.__("VAT Zero-Rated Sales")),1),Ms,Zs]),Ws,t("tr",null,[t("td",qs,s(e.__("TERMINAL TOTAL")),1),Js,t("td",Ks,s(e.nsCurrency(parseFloat((K=(J=r.result)==null?void 0:J.orders)==null?void 0:K.total)||0)),1)]),t("tr",null,[t("td",Qs,s(e.__("TRANSACTIONS")),1)]),t("tr",null,[t("td",Xs,s(e.__("Dine In")),1),t("td",Ys,s((X=(Q=r.result)==null?void 0:Q.orders)==null?void 0:X.dinein_count),1),t("td",$s,s(e.nsCurrency(parseFloat(($=(Y=r.result)==null?void 0:Y.orders)==null?void 0:$.dinein_total)||0)),1)]),t("tr",null,[t("td",te,s(e.__("Take Away")),1),t("td",se,s((st=(tt=r.result)==null?void 0:tt.orders)==null?void 0:st.takeaway_count),1),t("td",ee,s(e.nsCurrency(parseFloat((rt=(et=r.result)==null?void 0:et.orders)==null?void 0:rt.takeaway_total)||0)),1)]),t("tr",null,[t("td",re,s(e.__("TENDERS")),1),le]),(i(!0),d(Bt,null,zt((lt=r.result)==null?void 0:lt.payments,c=>(i(),d("tr",null,[t("td",oe,s(c.label),1),t("td",_e,s(c.count),1),t("td",ne,s(e.nsCurrency(parseFloat(c.total))),1)]))),256)),t("tr",null,[t("td",ce,s(e.__("DISCOUNTS")),1),ie]),t("tr",null,[t("td",de,s(e.__("SC")),1),t("td",ae,s((_t=(ot=r.result)==null?void 0:ot.orders)==null?void 0:_t.sc_count_disc),1),t("td",ue,s(e.nsCurrency(parseFloat((ct=(nt=r.result)==null?void 0:nt.orders)==null?void 0:ct.sc_total_disc)||0)),1)]),t("tr",null,[t("td",he,s(e.__("PWD")),1),t("td",pe,s((dt=(it=r.result)==null?void 0:it.orders)==null?void 0:dt.pwd_count_disc),1),t("td",me,s(e.nsCurrency(parseFloat((ut=(at=r.result)==null?void 0:at.orders)==null?void 0:ut.pwd_total_disc)||0)),1)]),t("tr",null,[t("td",xe,s(e.__("EMP")),1),t("td",ge,s((pt=(ht=r.result)==null?void 0:ht.orders)==null?void 0:pt.emp_count_disc),1),t("td",fe,s(e.nsCurrency(parseFloat((xt=(mt=r.result)==null?void 0:mt.orders)==null?void 0:xt.emp_total_disc)||0)),1)]),t("tr",null,[t("td",be,s(e.__("FREE")),1),t("td",ye,s((ft=(gt=r.result)==null?void 0:gt.orders)==null?void 0:ft.free_count_disc),1),t("td",ve,s(e.nsCurrency(parseFloat((yt=(bt=r.result)==null?void 0:bt.orders)==null?void 0:yt.free_total_disc)||0)),1)]),t("tr",null,[t("td",Ce,s(e.__("REG")),1),t("td",Se,s((Ct=(vt=r.result)==null?void 0:vt.orders)==null?void 0:Ct.reg_count_disc),1),t("td",Fe,s(e.nsCurrency(parseFloat((Ft=(St=r.result)==null?void 0:St.orders)==null?void 0:Ft.reg_total_disc)||0)),1)]),we,t("tr",null,[t("td",Te,s((wt=r.result)==null?void 0:wt.generated_date),1)])])])],8,cs)])])):Lt("",!0)])])])}const Ie=Vt(Gt,[["render",Le]]);export{Ie as default};

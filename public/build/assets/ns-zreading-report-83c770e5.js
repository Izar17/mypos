import{h as Et}from"./tax-eb5bf660.js";import{b as Tt,a as u}from"./bootstrap-5a04e768.js";import{c as Ut,e as kt}from"./components-6937a31d.js";import{_ as n,n as Rt}from"./currency-ddd33518.js";import{j as Dt}from"./join-array-e2975c21.js";import{b as Nt}from"./ns-prompt-popup-6756df12.js";import{_ as Ot}from"./_plugin-vue_export-helper-c27b6911.js";import{r as Vt,o as i,c as d,b as t,e as Pt,n as jt,t as s,f as Lt,F as It,g as Bt}from"./runtime-core.esm-bundler-f73e6c98.js";import"./chart-2ccf8ff7.js";import"./ns-alert-popup-28d70b9e.js";import"./ns-avatar-image-6a057f76.js";import"./index.es-d23fcd79.js";const zt={name:"ns-zreading-report",data(){return{saleReport:"",startDateField:{name:"start_date",type:"datetime",value:ns.date.moment.startOf("day").format()},result:{},isLoading:!1,users:[],ns:window.ns,selectedUser:"",filterUser:{label:n("Filter User"),name:"filterUser",type:"select",value:"",options:[],description:n("Allow you to choose the report type.")},field:{type:"datetimepicker",value:"2021-02-07",name:"date"}}},components:{nsDatepicker:Ut,nsDateTimePicker:kt},computed:{},methods:{__:n,nsCurrency:Rt,joinArray:Dt,printSaleReport(){this.$htmlToPaper("sale-report")},async openUserFiltering(){try{this.isLoading=!0;const l=await new Promise((o,a)=>{Tt.get("/api/users").subscribe({next:r=>{this.users=r,this.isLoading=!1,this.filterUser.options=[{label:n("All Users"),value:""},...this.users.map(e=>({label:e.username,value:e.id}))],Popup.show(Nt,{...this.filterUser,resolve:o,reject:a})},error:r=>{this.isLoading=!1,u.error(n("No user was found for proceeding the filtering.")),a(r)}})}),_=this.users.filter(o=>o.id===l);if(_.length>0){let o=_[0];this.selectedUser=`${o.username} ${o.first_name||o.last_name?o.first_name+" "+o.last_name:""}`,this.filterUser.value=l,this.result=[],this.loadReport()}}catch(l){console.log({exception:l})}},loadReport(){if(this.startDate===null)return u.error(n("Unable to proceed. Select a correct time range.")).subscribe();Et(this.startDate),this.isLoading=!0,Tt.post("/api/reports/xzreading-report",{startDate:this.startDateField.value,user_id:this.filterUser.value}).subscribe({next:l=>{this.isLoading=!1,this.result=l.result,console.log(this.result)},error:l=>{this.isLoading=!1,u.error(l.message).subscribe()}})}},props:["storeLogo","storeName"],mounted(){}},Gt={id:"report-section",class:"px-4"},Ht={class:"flex -mx-2"},Mt={class:"px-2"},Zt={class:"px-2"},Wt={class:"pl-2"},qt={class:"px-2"},Jt=t("i",{class:"las la-print text-xl"},null,-1),Kt={class:"pl-2"},Qt={id:"sale-report",class:"anim-duration-500 fade-in-entrance"},Xt={key:0,class:"w-full h-full pt-5"},Yt={class:"w-full md:w-1/2 lg:w-1/3 shadow-lg bg-white p-2 mx-auto"},$t={class:"flex items-center justify-center"},ts={class:"text-sm font-bold"},ss={class:"flex items-center justify-center"},es={class:"text-sm font-bold"},rs={class:"flex items-center justify-center"},ls={class:"text-sm font-bold"},os=t("div",{class:"p-2"},[t("div",{class:"flex flex-wrap -mx-2 text-xs"})],-1),_s=["set"],cs={class:"w-full"},is={key:0},ds={class:"text-xs"},as={colspan:"2",class:"text-left"},us=t("tr",{class:"border-b"},null,-1),hs={class:"text-xs"},ps={class:""},ms={class:"text-right"},xs={class:"text-right"},gs={class:""},fs={class:"text-right"},bs={class:"text-right"},ys={class:""},vs={class:"text-right"},Cs={class:"text-right"},Ss=t("tr",{class:"border-b"},null,-1),Fs={class:""},ws={class:"text-right"},Ts={class:"text-right"},Ls={class:""},As=t("td",null,null,-1),Es={class:"text-right"},Us={class:""},ks=t("td",null,null,-1),Rs={class:"text-right"},Ds={class:""},Ns=t("td",null,null,-1),Os={class:"text-right"},Vs={class:""},Ps=t("td",null,null,-1),js={class:"text-right"},Is={class:""},Bs=t("td",null,null,-1),zs={class:"text-right"},Gs={class:""},Hs=t("td",null,null,-1),Ms=t("td",{class:"text-right"},"0",-1),Zs=t("tr",{class:"border-b"},null,-1),Ws={class:""},qs=t("td",null,null,-1),Js={class:"text-right"},Ks={class:""},Qs={class:"pl-3"},Xs={class:"text-right"},Ys={class:"text-right"},$s={class:"pl-3"},te={class:"text-right"},se={class:"text-right"},ee={class:""},re=t("td",{class:"text-right"},null,-1),le={class:"pl-3"},oe={class:"text-right"},_e={class:"text-right"},ne={class:""},ce=t("td",{class:"text-right"},null,-1),ie={class:"pl-3"},de={class:"text-right"},ae={class:"text-right"},ue={class:"pl-3"},he={class:"text-right"},pe={class:"text-right"},me={class:"pl-3"},xe={class:"text-right"},ge={class:"text-right"},fe={class:"pl-3"},be={class:"text-right"},ye={class:"text-right"},ve={class:"pl-3"},Ce={class:"text-right"},Se={class:"text-right"},Fe=t("tr",{class:"border-b"},null,-1),we={colspan:"3",class:"text-center"};function Te(l,_,o,a,r,e){var h,p,m,x,g,f,b,y,v,C,S,F,w,T,L,A,E,U,k,R,D,N,O,V,P,j,I,B,z,G,H,M,Z,W,q,J,K,Q,X,Y,$,tt,st,et,rt,lt,ot,_t,nt,ct,it,dt,at,ut,ht,pt,mt,xt,gt,ft,bt,yt,vt,Ct,St,Ft,wt;const At=Vt("ns-date-time-picker");return i(),d("div",Gt,[t("div",Ht,[t("div",Mt,[Pt(At,{field:r.startDateField},null,8,["field"])]),t("div",Zt,[t("button",{onClick:_[0]||(_[0]=c=>e.loadReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[t("i",{class:jt([r.isLoading?"animate-spin":"","las la-sync-alt text-xl"])},null,2),t("span",Wt,s(e.__("Load")),1)])]),t("div",qt,[t("button",{onClick:_[1]||(_[1]=c=>e.printSaleReport()),class:"rounded flex justify-between bg-input-button shadow py-1 items-center text-primary px-2"},[Jt,t("span",Kt,s(e.__("Print")),1)])])]),t("div",null,[t("div",Qt,[r.result.store_name?(i(),d("div",Xt,[t("div",Yt,[t("div",$t,[t("p",ts,s(r.result.store_name),1)]),t("div",ss,[t("p",es,s(r.result.title),1)]),t("div",rs,[t("p",ls,s(r.result.date),1)]),os,t("div",{class:"table w-full text-xs",set:l.vat_12=parseFloat((p=(h=r.result)==null?void 0:h.orders)==null?void 0:p.vatable)+parseFloat((x=(m=r.result)==null?void 0:m.orders)==null?void 0:x.sc_vatable)-(parseFloat((f=(g=r.result)==null?void 0:g.orders)==null?void 0:f.vatable)+parseFloat((y=(b=r.result)==null?void 0:b.orders)==null?void 0:y.sc_vatable))/1.12},[t("table",cs,[r.result.cashier?(i(),d("tr",is,[t("td",ds,s(e.__("Cashier Name:")),1),t("td",as,s((v=r.result)==null?void 0:v.cashier),1)])):Lt("",!0),us,t("tbody",hs,[t("tr",null,[t("td",ps,s(e.__("TOTAL SALES")),1),t("td",ms,s((S=(C=r.result)==null?void 0:C.orders)==null?void 0:S.total_sales_count),1),t("td",xs,s(e.nsCurrency((w=(F=r.result)==null?void 0:F.orders)==null?void 0:w.total_sales)),1)]),t("tr",null,[t("td",gs,s(e.__("LESS TOTAL REFUND")),1),t("td",fs,s((L=(T=r.result)==null?void 0:T.orders)==null?void 0:L.total_refunds_count),1),t("td",bs,s(e.nsCurrency((E=(A=r.result)==null?void 0:A.orders)==null?void 0:E.total_refunds)),1)]),t("tr",null,[t("td",ys,s(e.__("LESS TOTAL DISCOUNT")),1),t("td",vs,s((k=(U=r.result)==null?void 0:U.orders)==null?void 0:k.total_disc_count),1),t("td",Cs,s(e.nsCurrency((D=(R=r.result)==null?void 0:R.orders)==null?void 0:D.total_disc)),1)]),Ss,t("tr",null,[t("td",Fs,s(e.__("SUBTOTAL")),1),t("td",ws,s((O=(N=r.result)==null?void 0:N.orders)==null?void 0:O.total_sales_count),1),t("td",Ts,s(e.nsCurrency((P=(V=r.result)==null?void 0:V.orders)==null?void 0:P.subtotal)),1)]),t("tr",null,[t("td",Ls,s(e.__("SERVICE CHARGE")),1),As,t("td",Es,s(e.nsCurrency((I=(j=r.result)==null?void 0:j.orders)==null?void 0:I.service_charge)),1)]),t("tr",null,[t("td",Us,s(e.__("LESS 12% VAT")),1),ks,t("td",Rs,s(e.nsCurrency(l.vat_12||0)),1)]),t("tr",null,[t("td",Ds,s(e.__("NET SALES")),1),Ns,t("td",Os,s(e.nsCurrency(parseFloat(((z=(B=r.result)==null?void 0:B.orders)==null?void 0:z.total)-l.vat_12)||0)),1)]),t("tr",null,[t("td",Vs,s(e.__("VATable Sales")),1),Ps,t("td",js,s(e.nsCurrency(parseFloat((H=(G=r.result)==null?void 0:G.orders)==null?void 0:H.vatable)+parseFloat((Z=(M=r.result)==null?void 0:M.orders)==null?void 0:Z.sc_vatable)||0)),1)]),t("tr",null,[t("td",Is,s(e.__("VAT-Exempt Sales")),1),Bs,t("td",zs,s(e.nsCurrency(parseFloat((q=(W=r.result)==null?void 0:W.orders)==null?void 0:q.vat_exempt)||0)),1)]),t("tr",null,[t("td",Gs,s(e.__("VAT Zero-Rated Sales")),1),Hs,Ms]),Zs,t("tr",null,[t("td",Ws,s(e.__("TERMINAL TOTAL")),1),qs,t("td",Js,s(e.nsCurrency(parseFloat((K=(J=r.result)==null?void 0:J.orders)==null?void 0:K.total)||0)),1)]),t("tr",null,[t("td",Ks,s(e.__("TRANSACTIONS")),1)]),t("tr",null,[t("td",Qs,s(e.__("Dine In")),1),t("td",Xs,s((X=(Q=r.result)==null?void 0:Q.orders)==null?void 0:X.dinein_count),1),t("td",Ys,s(e.nsCurrency(parseFloat(($=(Y=r.result)==null?void 0:Y.orders)==null?void 0:$.dinein_total)||0)),1)]),t("tr",null,[t("td",$s,s(e.__("Take Away")),1),t("td",te,s((st=(tt=r.result)==null?void 0:tt.orders)==null?void 0:st.takeaway_count),1),t("td",se,s(e.nsCurrency(parseFloat((rt=(et=r.result)==null?void 0:et.orders)==null?void 0:rt.takeaway_total)||0)),1)]),t("tr",null,[t("td",ee,s(e.__("TENDERS")),1),re]),(i(!0),d(It,null,Bt((lt=r.result)==null?void 0:lt.payments,c=>(i(),d("tr",null,[t("td",le,s(c.label),1),t("td",oe,s(c.count),1),t("td",_e,s(e.nsCurrency(parseFloat(c.total))),1)]))),256)),t("tr",null,[t("td",ne,s(e.__("DISCOUNTS")),1),ce]),t("tr",null,[t("td",ie,s(e.__("SC")),1),t("td",de,s((_t=(ot=r.result)==null?void 0:ot.orders)==null?void 0:_t.sc_count_disc),1),t("td",ae,s(e.nsCurrency(parseFloat((ct=(nt=r.result)==null?void 0:nt.orders)==null?void 0:ct.sc_total_disc)||0)),1)]),t("tr",null,[t("td",ue,s(e.__("PWD")),1),t("td",he,s((dt=(it=r.result)==null?void 0:it.orders)==null?void 0:dt.pwd_count_disc),1),t("td",pe,s(e.nsCurrency(parseFloat((ut=(at=r.result)==null?void 0:at.orders)==null?void 0:ut.pwd_total_disc)||0)),1)]),t("tr",null,[t("td",me,s(e.__("EMP")),1),t("td",xe,s((pt=(ht=r.result)==null?void 0:ht.orders)==null?void 0:pt.emp_count_disc),1),t("td",ge,s(e.nsCurrency(parseFloat((xt=(mt=r.result)==null?void 0:mt.orders)==null?void 0:xt.emp_total_disc)||0)),1)]),t("tr",null,[t("td",fe,s(e.__("FREE")),1),t("td",be,s((ft=(gt=r.result)==null?void 0:gt.orders)==null?void 0:ft.free_count_disc),1),t("td",ye,s(e.nsCurrency(parseFloat((yt=(bt=r.result)==null?void 0:bt.orders)==null?void 0:yt.free_total_disc)||0)),1)]),t("tr",null,[t("td",ve,s(e.__("REG")),1),t("td",Ce,s((Ct=(vt=r.result)==null?void 0:vt.orders)==null?void 0:Ct.reg_count_disc),1),t("td",Se,s(e.nsCurrency(parseFloat((Ft=(St=r.result)==null?void 0:St.orders)==null?void 0:Ft.reg_total_disc)||0)),1)]),Fe,t("tr",null,[t("td",we,s((wt=r.result)==null?void 0:wt.generated_date),1)])])])],8,_s)])])):Lt("",!0)])])])}const Ie=Ot(zt,[["render",Te]]);export{Ie as default};
